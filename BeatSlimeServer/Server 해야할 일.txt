같은 객체를 다루는 코드는 한 곳에 몰아놓자 

타이머 큐
	- 포인터를 담는 걸로 바꿀까? 이점이 뭐가 있을까 생각해보자
패턴
	패턴을 이벤트로 등록해서 사용하기 때문에 게임 중 딜레이를 줄이려면 이 부분을 잘 만들어야됨
	** 보스는 공격하고 바로 이동 금지!!
	- (22.03.04)현재 상태
		
		- 게임이 시작하면 모든 패턴을 이벤트에 등록함
		- 문제점
			- 플레이어가 모두 죽을 경우 의미없는 이벤트가 계속 발생
			- 플레이어가 중간에 나갈 경우 의미없는 이벤트가 계속 발생
			- 모든 플레이어가 나갈 경우 오류 발생
		- 해결 방법
			- 게임 룸마다 현재 패턴 진행사항을 저장해 한 개의 패턴이 완료되면 그 다음 패턴을 이벤트로 등록하도록 한다.
				- timer thread말고 worker thread에서 이벤트를 등록하자 priority_queue::push가 log n의 시간이 걸릴 테니
			- 예상되는 문제점
				- 단일 블록 공격 패턴의 경우 같은 시간에 저장될 수 있는데, 게임 룸이 많아지면 딜레이가 생길 것이다. 
					-> 같은 시간에 있는 패턴은 합쳐서 진행할 수 없을까?
					-> 만약 같은 시간에 있는 패턴을 합친다면 이벤트 간 최소 간격은 bpm에 따라 결정 될 것이다.
				
				- 패턴간의 시간 텀이 짧으면 한 개의 패턴이 완료되기 전에 그 다음 패턴을 이벤트로 등록해야될 것이다.
					-> 이벤트 큐에서 꺼내자 마자 바로 다음 이벤트를 등록하자
	- (22.03.08)
		- 패링 패턴이 가끔씩 박자가 밀림
			- 비트 표시기의 경우 클라이언트에서 자체적으로 읽어서 표시함
			 즉 서버 클라이언트의 게임 시작시간이 다르면 밀릴 수 있다.
			 
		**아래의 문제를 해결하면 동시에 해결될 문제라고 생각( 이펙트와 피격을 맞추기 위해 서버와 클라이언트간의 게임 플레이 타임의 동기화가 필요할 것이기 때문)
		
		- (03.12)기존 서버에서 패턴의 시작시간과 피격결과를 알려주던 걸 클라이언트에서 패턴 시작시간을 파일에서 읽어와 이펙트를 출력하고 서버에서는 피격판정만 하도록하자
			- 이렇게 하는 이유
				-> 패턴의 시작시간은 비쥬얼을 보여줘 플레이어가 피할 수 있도록 하는 것이 목표이다. 즉 비쥬얼이 필요없는 서버에서는 굳이 처리할 필요가 없는 동작인 것이다.
			- 구현하기 위해 필요한 것들
				- 서버와 클라이언트 인 게임 플레이 시간 동기화 
					- server에서 game_start패킷을 보낼 때 현재 서버시간도 같이 보낸다 -> 인게임 클라이언트들이 같은 서버 start time을 알게 된다. -> 클라 머신에서의 system시간과 비교해 각 머신에서 시작 시간..
					- 하지만 start time을 알게 됐다 한들 뭐 할 수 있는게 없음 이 정보를 가지고 음악 재생 위치를 옮겨야 하고 패턴 이펙트를 올바른 시간에 출력해야함
					- 그렇게 하려면 서버에서 계속 경과시간을 보내야함
				- 클라이언트에서 패턴 파일 읽고 이펙트 출력
				- 서버의 패턴 시작시간 이벤트 삭제
			- 예상되는 문제점
				- 클라이언트가 중간에 나간다면? 죽는다면? 해당 클라이언트의 플레이어를 공격하는 패턴의 경우는 어떤 방식으로 처리해야 할까?
				     -> 인 게임에 있는 모든 클라이언트는 다른 클라이언트가 나가거나 죽으면 알 수 있다.
					이 맵에서 체력이 제일 많거나 적은 플레이어를 알 수 있다.
					이런 정보들은 클라이언트를 해킹하지 않는 이상 서버와 클라가 같은 값을 찾을 수 있도록 해줄 것이다. 
					만약 클라이언트를 해킹해 패턴을 바꾼다고 해도 피격판정은 서버에서 처리하기 때문에 자신만 손해를 보게 될 것이다.
					? 하지만 해킹의 목적이 그냥 게임 클리어라면? -> 패턴을 모두 알고있기 때문에 매크로를 만들 수 있음 -> 이건 모든 리듬게임에 포함되는 문제아닌가?
						- 패턴의 시작시간을 알려준다해도 매크로를 사용하면 모든 공격을 피할 수 있긴함
						* 이 문제는 로직의 문제가 아니라 리듬게임의 문제가 아닐까 생각, 다음에 다시 생각해보자
				- 서버가 느려지면 모든 클라이언트가 다 느려져야하는건가? 리듬게임인데?
					- 서버 안 느려지게 만들면 되지 클라가 느려지면.. 생각해보자
				- ...해보자
			
스킬
	스킬 레벨에 따라...

DB
	...

스크립트
	lua를 사용해 각 패턴 타입에 맞는 공격 함수 호출

클라이언트
	- (22.03.11)플레이어
		- 게임이 시작한 플레이어는 remove되야함 해결할 것
	-  (22.03.14)서버는 이미 게임을 시작했고 패킷을 받고 뒤늦게 시작하는 클라가 서버의 시작시간을 따라가야 한다.
           클라에서 생기는 지연시간
           	- 패킷 오가는 시간
            	- ping 패킷을 이용해 최근 주고받은 핑10개의 평균을 낸 시간을 구할 수 있도록 만든다.
          	- 게임 start 패킷을 받고 PlaySound를 할 때 걸리는 시간
            	- offsetTimed이라는 변수에 PlaySound를 할 때 걸리는 시간을 계산한다.
           
	- 22.03.15) 문제점
		- 장판을 못피함
			- 클라에서 눈으로 보여지는 이펙트와 서버에서 피격 판정을 하는 시간이 안 맞는 이유 뿐이겠지
			- peekpattern이 제시간에 잘 동작하는가? -> update가 fixed라 제 시간동작이 어렵겠는걸? -> 아닌걸?
				눈에 보이는 위치는 피해졌음 -> 서버에서의 플레이어 좌표 이동도 완료된 상태라는 뜻
				장판이 커지는 크기와 플레이어가 피격되는 시간은 동일함 
					->
			
            	ping 평균과 offsetTimed을 nowSongTime에 더하여 현재 패턴의 진행 사항을 조정한다.
         	 ** 음악의 재생위치도 조정해야할까?
	// 게임 시작시간만 알고있으면 경과시간은 필요 없다고 판단됨
        // 서버가 렉이 걸린다해도 경과시간(시스템시간)은 일정하게 지나갈것이고 그건 클라이언트에서 시간을 측정해도 똑같은 결과를 얻을 수 있음
        // 서버의 렉을 판정하려면 ping test패킷을 보내 패킷을 다시 받는데 걸리는 시간을 측정해 딜레이 시간을 계산하는 것이 옳은 방법이라 생각
	